---

- name: Invoke r10k to update Puppetfile
  command: r10k deploy environment {{ environment }} -v

- name: Invoke r10k to deploy a specific module in a specific environment
  command: r10k deploy module -e {{ environment }} {{ module }} -v
  register: r10k

- fail: msg="R10k command returned no output. This is most likely that the environment or module didn't exist"
  when: r10k.stderr == ""
